extends layout

block content
  .mockup
    .mockup-header
      h3= siteName || "My Digital Diary"
      div
        if user
          button.btn= user.name
        else
          button.btn Login

    .nav
      ul
        each item in navItems || [{text: "Homepage", url: "#", active: true}, {text: "Categories", url: "category.html"}, {text: "Tags", url: "#"}, {text: "About", url: "#"}]
          li
            a(href=item.url, class=item.active ? "active" : "")= item.text

    .mockup-body
      h2= welcomeHeader || "Welcome to My Digital Diary"
      p= welcomeMessage || "This is my personal digital space where I share my thoughts, experiences, and memories."

      .search-box
        input(type="text" placeholder=searchPlaceholder || "Search my diary..." id="search-input")
        button(onclick="performSearch()")= searchButtonText || "Search"

      h3 Filter by Tag
      .tag-list#filter-tags
        span.tag(onclick="filterByTag('All')") All
        each tag in allTags || []
          span.tag(onclick=`filterByTag('${tag.name}')`)= tag.name

      h3= entriesHeader || "Recent Entries"
      .timeline
        each entry in entries || []
          .timeline-item
            .timeline-date= entry.date
            h4= entry.title
            p= entry.excerpt
            .tag-list
              if entry.tags && entry.tags.length
                each tag in entry.tags
                  if tag && tag.name
                    span.tag= tag.name
            //- Use the MongoDB _id (converted to string in formatEntries)
            if entry.id
              a.btn(href=`/entry/${entry.id}`)= readMoreText || "Read More"
            else
              //- Show a disabled button and log the issue
              button.btn(disabled style="opacity: 0.5" onclick=`console.log('No ID found for entry:', this.dataset.entry)` data-entry=JSON.stringify(entry))= readMoreText || "Read More (No ID)"

      if entries && entries.length === 0
        p.no-entries= noEntriesMessage || "No entries found."

      //- DEBUG: Show entry data in development
      if process.env.NODE_ENV === 'development'
        details(style="margin-top: 2rem; padding: 1rem; background: #f5f5f5; border-radius: 4px;")
          summary Debug: Entry Data
          pre(style="white-space: pre-wrap; font-size: 12px;")= JSON.stringify(entries, null, 2)

  if scripts && scripts.length > 0
    each script in scripts
      script(src=script)