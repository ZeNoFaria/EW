extends layout

block content
  .container.mt-4
    if entry
      article.entry-detail
        .row
          .col-lg-8.offset-lg-2
            header.mb-4
              h1.display-5= entry.title
              .d-flex.justify-content-between.align-items-center.text-muted.mb-3
                time= entry.date
                if entry.category
                  span.badge.bg-info= entry.category
              
              if entry.tags && entry.tags.length > 0
                .mb-3
                  each tag in entry.tags
                    span.badge.bg-secondary.me-1= tag

            .entry-content.mb-4
              if entry.content
                .lh-lg!= entry.content.replace(/\n/g, '<br>')
              else if entry.excerpt
                p.lead= entry.excerpt
              else
                p.text-muted No content available.

            footer.border-top.pt-4
              .d-flex.gap-2.mb-4
                button.btn.btn-outline-secondary(onclick="history.back()")
                  i.fas.fa-arrow-left.me-2
                  | Back
                button.btn.btn-outline-primary(onclick=`shareEntry('${entry.id}', '${entry.title}')`)
                  i.fas.fa-share.me-2
                  | Share
                if entry.editUrl
                  a.btn.btn-outline-warning(href=entry.editUrl)
                    i.fas.fa-edit.me-2
                    | Edit

              if entry.relatedEntries && entry.relatedEntries.length > 0
                .related-entries
                  h4 Related Entries
                  .row
                    each related in entry.relatedEntries
                      .col-md-6.mb-3
                        .card
                          .card-body
                            h6.card-title
                              a.text-decoration-none(href=`/entry/${related.id}`)= related.title
                            p.card-text.small= related.excerpt
                            small.text-muted= related.date
    else
      .text-center.py-5
        i.fas.fa-exclamation-triangle.fa-3x.text-warning.mb-3
        h2 Entry Not Found
        p.text-muted The entry you're looking for doesn't exist or has been removed.
        a.btn.btn-primary(href="/") Back to Home

block scripts
  script.
    function shareEntry(id, title) {
      if (navigator.share) {
        navigator.share({
          title: title,
          text: `Check out this diary entry: ${title}`,
          url: window.location.href
        }).catch(err => console.log('Error sharing:', err));
      } else {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          alert('Link copied to clipboard!');
        }).catch(() => {
          prompt('Copy this link:', url);
        });
      }
    }